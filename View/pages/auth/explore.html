<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore Map</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet.js for the interactive map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Custom styles to ensure the map fills the screen and for the font */
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* Prevents scrolling the body */
        }
        #map {
            /* The map will fill the entire viewport */
            height: 100vh;
            width: 100vw;
        }
        /* Remove the default blue outline on active buttons for a cleaner mobile experience */
        .nav-button:focus {
            outline: none;
        }
        /* Style for the active navigation button */
        .nav-button.active svg {
            color: #ffffff; /* White color for the active icon */
        }
        .nav-button.active span {
            color: #ffffff; /* White color for the active text */
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- The main container for the map -->
    <div id="map"></div>

    <!-- Bottom Navigation Bar -->
    <!-- This bar is fixed to the bottom of the screen -->
    <nav class="fixed bottom-0 left-0 right-0 bg-blue-800 shadow-lg z-[1000]">
        <div class="max-w-md mx-auto h-20 flex justify-around items-center">
            
            <!-- Navigation Button 1: Explore (Active) -->
            <button class="nav-button active flex flex-col items-center justify-center text-gray-400 w-1/4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
                </svg>
                <span class="text-xs font-medium">Explore</span>
            </button>

            <!-- Navigation Button 2: Analyze -->
            <button class="nav-button flex flex-col items-center justify-center text-gray-400 w-1/4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-7 w-7 mb-1">
                     <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                </svg>
                <span class="text-xs font-medium">Analyze</span>
            </button>

            <!-- Navigation Button 3: Fishpedia -->
            <button class="nav-button flex flex-col items-center justify-center text-gray-400 w-1/4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-7 w-7 mb-1">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                </svg>
                <span class="text-xs font-medium">Fishpedia</span>
            </button>

            <!-- Navigation Button 4: Settings -->
            <button class="nav-button flex flex-col items-center justify-center text-gray-400 w-1/4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mb-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                </svg>
                <span class="text-xs font-medium">Settings</span>
            </button>
        </div>
    </nav>

    <script>
        // --- Initialize the Map ---
        // The map is centered on Jakarta, Indonesia, as a fallback location.
        const map = L.map('map').setView([-6.2088, 106.8456], 12);

        // --- Add the Tile Layer from OpenStreetMap ---
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        // --- Get User Location ---
        // This function will run when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Check if Geolocation is supported by the browser
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                console.log("Geolocation is not supported by this browser.");
            }
        });

        // --- Function to handle successful location retrieval ---
        function showPosition(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            // Center the map on the user's location with a closer zoom
            map.setView([lat, lon], 15);

            // Add a marker at the user's location
            const marker = L.marker([lat, lon]).addTo(map);
            marker.bindPopup("<b>You are here</b>").openPopup();

            // Add a circle to show the location accuracy
            L.circle([lat, lon], {
                color: 'blue',
                fillColor: '#3085d6',
                fillOpacity: 0.2,
                radius: position.coords.accuracy
            }).addTo(map);
        }

        // --- Function to handle errors ---
        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    console.log("User denied the request for Geolocation.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    console.log("Location information is unavailable.");
                    break;
                case error.TIMEOUT:
                    console.log("The request to get user location timed out.");
                    break;
                case error.UNKNOWN_ERROR:
                    console.log("An unknown error occurred.");
                    break;
            }
        }

        // --- Navigation Bar Interactivity ---
        const navButtons = document.querySelectorAll('.nav-button');
        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                navButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const action = button.querySelector('span').textContent;
                console.log(`Navigated to: ${action}`);
            });
        });
    </script>

</body>
</html>
